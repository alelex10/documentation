---
layout: "/layout.astro"
---

# Bases de Datos NoSQL

Las bases de datos NoSQL son un tipo de sistema de gesti√≥n de bases de datos que no utilizan el lenguaje SQL ni siguen el modelo relacional tradicional. En lugar de eso, emplean diversos modelos de datos como clave-valor, documentos, columnas ampliadas o grafos. Esto las hace m√°s flexibles y adecuadas para aplicaciones que requieren manejar grandes cantidades de datos no estructurados o semi-estructurados, escalabilidad horizontal y alta disponibilidad.

# ‚úÖ Caracter√≠sticas Clave

1. **Esquema flexible o sin esquema**: Las bases de datos NoSQL no requieren un esquema fijo, lo que permite una adaptabilidad mayor a medida que evoluciona la aplicaci√≥n.

2. **Tipos de datos variados**: Incluyen diferentes modelos de datos como almacenes de clave-valor, bases de datos de documentos, almacenes de columnas y bases de datos de grafos, cada uno adaptado a distintos casos de uso.

3. **Escalabilidad horizontal**: Dise√±adas para escalar aumentando el n√∫mero de servidores, lo que facilita manejar grandes vol√∫menes de datos y tr√°fico de manera costo-efectiva.

4. **Alta disponibilidad y tolerancia a fallas**: Distribuyen los datos en m√∫ltiples nodos, garantizando que el sistema funcione correctamente incluso si alguno de ellos deja de estar disponible.

5. **Manejo de grandes datos**: Optimizadas para manejar grandes cantidades de datos no estructurados o semiestructurados, ideales para entornos de big data y aplicaciones en tiempo real.

6. **Consultas y indexaci√≥n eficientes**: Aunque no soportan las complejas uniones de las bases de datos relacionales, est√°n optimizadas para recuperaciones de datos r√°pidas mediante el uso eficiente de √≠ndices.

7. **Costo-efectividad**: Pueden ejecutarse en hardware convencional y escalar horizontalmente, lo que puede ser m√°s econ√≥mico que invertir en hardware especializado.

En resumen, las bases de datos NoSQL destacan por su flexibilidad, escalabilidad y capacidad para manejar grandes y variados conjuntos de datos, lo que las hace ideales para aplicaciones modernas y din√°micas.

# Crear una coleccion en MongoDB

```js
// Crear una colecci√≥n expl√≠citamente
// no valida el esquema de la coleccion
db.createCollection("alumnos")

// Crear colecci√≥n con opciones - "nuevo"
// valida el esquema de la coleccion, o sea que los documentos deben cumplir con el esquema definido
db.createCollection("profesores", {
  validator: {
    $jsonSchema: {
      bsonType: "object",
      required: ["nombre", "edad", "especialidad"],
      properties: {
        nombre: { bsonType: "string" },
        edad: { bsonType: "int", minimum: 25, maximum: 70 },
        especialidad: { bsonType: "string" }
      }
    }
  }
})

// Listar colecciones
show collections

// Obtener informaci√≥n de una colecci√≥n
db.alumnos.stats()

// Renombrar colecci√≥n
db.alumnos.renameCollection("estudiantes")

// Eliminar colecci√≥n
db.alumnos.drop()

// Eliminar colecci√≥n con confirmaci√≥n
db.runCommand({ drop: "alumnos" })
```

## üìù Insertar Documentos - Operaciones de Escritura

```js
// Inserci√≥n b√°sica
db.alumnos.insertOne({
  nombre: "Luis",
  edad: 22,
  email: "luis@gmail.com",
  materias: ["Matem√°ticas", "F√≠sica", "Qu√≠mica"],
  promedio: 8.5,
  activo: true,
  fechaIngreso: new Date(),
  direccion: {
    calle: "Av. Independencia 123",
    ciudad: "Chubut",
    codigoPostal: "4564",
  },
});

// Con _id personalizado
db.alumnos.insertOne({
  _id: "ALU001",
  nombre: "Carlos",
  edad: 24,
  materias: ["Qu√≠mica", "Biolog√≠a"],
  promedio: 7.8,
});
```

## Insertar m√∫ltiples documentos:

```js
db.alumnos.insertMany([
  {
    nombre: "Ana",
    edad: 21,
    email: "ana@gmail.com",
    materias: ["Historia", "Literatura", "Filosof√≠a"],
    promedio: 9.2,
    becario: true,
    direccion: {
      calle: "San Mart√≠n 456",
      ciudad: "C√≥rdoba",
      codigoPostal: "5000",
    },
  },
  {
    nombre: "Diego",
    edad: 23,
    email: "diego@gmail.com",
    materias: ["Programaci√≥n", "Base de Datos", "Algoritmos"],
    promedio: 8.7,
    becario: false,
    direccion: {
      calle: "Belgrano 789",
      ciudad: "Rosario",
      codigoPostal: "2000",
    },
  },
  {
    nombre: "Mar√≠a",
    edad: 20,
    email: "maria@gmail.com",
    materias: ["Arte", "Dise√±o", "Historia del Arte"],
    promedio: 9.5,
    becario: true,
  },
]);

// Inserci√≥n con opciones
db.alumnos.insertMany(
  [
    { nombre: "Pedro", edad: 25 },
    { nombre: "Facundo", edad: 26 },
  ],
  { ordered: false }
); // Contin√∫a insertando aunque falle uno
```

## üîç Consultas y B√∫squedas - Operaciones de Lectura

```js
// Mostrar todos los documentos
db.alumnos.find();

// Contar documentos
db.alumnos.countDocuments();

// Encontrar uno solo
db.alumnos.findOne();

// Buscar por campo espec√≠fico
db.alumnos.find({ nombre: "Luc√≠a" });

// Buscar con m√∫ltiples condiciones (AND impl√≠cito)
db.alumnos.find({
  edad: 22,
  activo: true,
});
```

## Operadores de Comparaci√≥n:

```js
// Mayor que ($gt)
db.alumnos.find({ edad: { $gt: 22 } });

// Mayor o igual que ($gte)
db.alumnos.find({ promedio: { $gte: 9.0 } });

// Menor que ($lt)
db.alumnos.find({ edad: { $lt: 23 } });

// Menor o igual que ($lte)
db.alumnos.find({ promedio: { $lte: 8.0 } });

// Diferente de ($ne)
db.alumnos.find({ activo: { $ne: false } });

// En un array de valores ($in)
db.alumnos.find({ edad: { $in: [20, 21, 22] } });

// No en un array de valores ($nin)
db.alumnos.find({ edad: { $nin: [25, 26, 27] } });

// Existe el campo ($exists)
db.alumnos.find({ email: { $exists: true } });
```

## Operadores L√≥gicos:

```js
// OR
db.alumnos.find({
  $or: [{ promedio: { $gt: 9 } }, { becario: true }],
});

// AND expl√≠cito
db.alumnos.find({
  $and: [{ edad: { $gte: 20 } }, { edad: { $lte: 25 } }],
});

// NOT
db.alumnos.find({
  promedio: { $not: { $lt: 8.0 } },
});

// NOR (ni uno ni otro)
db.alumnos.find({
  $nor: [{ edad: { $lt: 20 } }, { promedio: { $lt: 7.0 } }],
});
```

## Consultas en Arrays:

```js
// Buscar documentos que tengan un elemento espec√≠fico en un array
db.alumnos.find({ materias: "Matem√°ticas" });

// Buscar con m√∫ltiples elementos (todos deben estar presentes)
db.alumnos.find({ materias: { $all: ["Matem√°ticas", "F√≠sica"] } });

// Buscar por tama√±o de array
db.alumnos.find({ materias: { $size: 3 } });

// Usar $elemMatch para condiciones complejas en arrays
db.alumnos.find({
  notas: {
    $elemMatch: {
      materia: "Matem√°ticas",
      calificacion: { $gte: 8 },
    },
  },
});
```

## Consultas en Documentos Anidados:

```js
// Buscar en documento anidado usando notaci√≥n de punto
db.alumnos.find({ "direccion.ciudad": "Chubut" });

// M√∫ltiples campos en documento anidado
db.alumnos.find({
  "direccion.ciudad": "C√≥rdoba",
  "direccion.codigoPostal": "5000",
});
```

## Expresiones Regulares:

```js
// Buscar nombres que contengan "Ana"
db.alumnos.find({ nombre: /Ana/ });

// Insensible a may√∫sculas/min√∫sculas
db.alumnos.find({ nombre: /ana/i });

// Que empiece con "M"
db.alumnos.find({ nombre: /^M/ });

// Que termine con "ez"
db.alumnos.find({ nombre: /ez$/ });
```

## Proyecci√≥n - Seleccionar Campos:

```js
// Mostrar solo nombre y edad (incluye _id por defecto)
db.alumnos.find({}, { nombre: 1, edad: 1 });

// Excluir _id
db.alumnos.find({}, { nombre: 1, edad: 1, _id: 0 });

// Excluir campos espec√≠ficos
db.alumnos.find({}, { direccion: 0, fechaIngreso: 0 });

// Proyecci√≥n en arrays (mostrar solo primer elemento)
db.alumnos.find({}, { "materias.$": 1 });

// Proyecci√≥n en arrays (mostrar primeros 2 elementos)
db.alumnos.find({}, { materias: { $slice: 2 } });

// Proyecci√≥n en arrays (mostrar √∫ltimos 2 elementos)
db.alumnos.find({}, { materias: { $slice: -2 } });
```

## Ordenamiento y Limitaci√≥n:

```js
// Ordenar por edad ascendente
db.alumnos.find().sort({ edad: 1 });

// Ordenar por promedio descendente
db.alumnos.find().sort({ promedio: -1 });

// Ordenamiento m√∫ltiple
db.alumnos.find().sort({ promedio: -1, edad: 1 });

// Limitar resultados
db.alumnos.find().limit(5);

// Saltar documentos (paginaci√≥n)
db.alumnos.find().skip(10).limit(5);

// Combinando todo
db.alumnos.find({ activo: true }).sort({ promedio: -1 }).limit(3);
```

# üõ†Ô∏è Actualizar Documentos - Operaciones de Modificaci√≥n

## Actualizaci√≥n de Un Documento:

```js
// Actualizar un campo
db.alumnos.updateOne(
  { nombre: "Carlos" },
  { $set: { promedio: 8.3, activo: true } }
);

// Incrementar un valor num√©rico
db.alumnos.updateOne({ nombre: "Ana" }, { $inc: { edad: 1 } });

// Agregar elemento a un array
db.alumnos.updateOne(
  { nombre: "Diego" },
  { $push: { materias: "Matem√°ticas Avanzadas" } }
);

// Agregar m√∫ltiples elementos a un array
db.alumnos.updateOne(
  { nombre: "Mar√≠a" },
  { $push: { materias: { $each: ["Escultura", "Pintura"] } } }
);

// Remover elemento de un array
db.alumnos.updateOne(
  { nombre: "Diego" },
  { $pull: { materias: "Algoritmos" } }
);

// Remover el √∫ltimo elemento de un array
db.alumnos.updateOne(
  { nombre: "Luc√≠a" },
  { $pop: { materias: 1 } } // 1 para √∫ltimo, -1 para primero
);

// Eliminar un campo
db.alumnos.updateOne({ nombre: "Carlos" }, { $unset: { fechaIngreso: "" } });

// Renombrar un campo
db.alumnos.updateOne({ nombre: "Ana" }, { $rename: { becario: "esBecario" } });
```

## Actualizaci√≥n de M√∫ltiples Documentos:

```js
// Actualizar todos los documentos que coincidan
db.alumnos.updateMany({ edad: { $lt: 22 } }, { $set: { categoria: "joven" } });

// Incrementar promedio para todos los becarios
db.alumnos.updateMany({ becario: true }, { $inc: { promedio: 0.5 } });
```

## Upsert (Actualizar o Insertar):

```js
// Si no existe, lo crea
db.alumnos.updateOne(
  { nombre: "Roberto" },
  {
    $set: {
      edad: 22,
      promedio: 8.0,
      materias: ["Introducci√≥n a la Programaci√≥n"],
    },
  },
  { upsert: true }
);
```

## Replace (Reemplazar Documento Completo):

```js
db.alumnos.replaceOne(
  { nombre: "Carlos" },
  {
    nombre: "Carlos",
    edad: 25,
    email: "carlos.mendez.nuevo@email.com",
    materias: ["Qu√≠mica Avanzada", "Biolog√≠a Molecular"],
    promedio: 8.8,
    graduado: false,
  }
);
```

## üóëÔ∏è Eliminar Documentos - Operaciones de Borrado

```js
// Eliminar un documento
db.alumnos.deleteOne({ nombre: "Ana" });

// Eliminar m√∫ltiples documentos
db.alumnos.deleteMany({ activo: false });

// Eliminar todos los documentos de la colecci√≥n
db.alumnos.deleteMany({});

// Encontrar y eliminar (devuelve el documento eliminado)
db.alumnos.findOneAndDelete({ promedio: { $lt: 6.0 } });
```

## üìä Agregaciones - Pipeline de Procesamiento

Las agregaciones son operaciones o funciones que se utilizan para resumir o combinar datos de un conjunto m√°s grande en un solo valor. Este t√©rmino se usa com√∫nmente en varios campos, como las bases de datos, el an√°lisis de datos y la programaci√≥n.

1. En Bases de Datos (SQL):
   En el contexto de las bases de datos, las funciones de agregaci√≥n se utilizan para resumir datos de una tabla. Algunas de las funciones m√°s comunes son:

SUM: Calcula la suma de un conjunto de valores.
COUNT: Cuenta el n√∫mero de filas o valores no nulos en una columna.
AVG: Calcula el promedio de un conjunto de valores.
MAX: Devuelve el valor m√°ximo de un conjunto de valores.
MIN: Devuelve el valor m√≠nimo de un conjunto de valores.

```js
// Promedio general de todos los alumnos
db.alumnos.aggregate([
  {
    $group: {
      _id: null,
      promedioGeneral: { $avg: "$promedio" },
      totalAlumnos: { $sum: 1 },
      promedioMaximo: { $max: "$promedio" },
      promedioMinimo: { $min: "$promedio" },
    },
  },
]);

// Agrupar por ciudad
db.alumnos.aggregate([
  {
    $group: {
      _id: "$direccion.ciudad",
      cantidadAlumnos: { $sum: 1 },
      promedioEdad: { $avg: "$edad" },
    },
  },
]);

// Estad√≠sticas por rango de edad
db.alumnos.aggregate([
  {
    $group: {
      _id: {
        $switch: {
          branches: [
            { case: { $lt: ["$edad", 21] }, then: "Menores de 21" },
            { case: { $lt: ["$edad", 25] }, then: "21-24 a√±os" },
          ],
          default: "25 a√±os o m√°s",
        },
      },
      cantidad: { $sum: 1 },
      promedioAcademico: { $avg: "$promedio" },
    },
  },
]);
```

# üîç √çndices - Optimizaci√≥n de Consultas

## Crear y Gestionar √çndices:

```js
// Crear √≠ndice simple
db.alumnos.createIndex({ nombre: 1 }); // 1 = ascendente, -1 = descendente

// Crear √≠ndice compuesto
db.alumnos.createIndex({ edad: 1, promedio: -1 });

// √çndice de texto para b√∫squedas
db.alumnos.createIndex({
  nombre: "text",
  "direccion.ciudad": "text",
});

// √çndice en documento anidado
db.alumnos.createIndex({ "direccion.ciudad": 1 });

// √çndice en array
db.alumnos.createIndex({ materias: 1 });

// √çndice √∫nico
db.alumnos.createIndex({ email: 1 }, { unique: true });
```

## Informaci√≥n de √çndices:

```js
// Listar todos los √≠ndices
db.alumnos.getIndexes();

// Eliminar √≠ndice
db.alumnos.dropIndex({ nombre: 1 });

// Eliminar todos los √≠ndices (excepto _id)
db.alumnos.dropIndexes();
```

## üîÑ Operaciones Bulk (Por Lotes)

```js
// Bulk write ordenado
db.alumnos.bulkWrite(
  [
    {
      insertOne: {
        document: {
          nombre: "Pedro Bulk",
          edad: 25,
          promedio: 8.0,
        },
      },
    },
    {
      updateOne: {
        filter: { nombre: "Luc√≠a Garc√≠a" },
        update: { $set: { promedio: 9.0 } },
      },
    },
    {
      deleteOne: {
        filter: { promedio: { $lt: 6.0 } },
      },
    },
  ],
  { ordered: true }
);

// Bulk write no ordenado (m√°s eficiente)
db.alumnos.bulkWrite(
  [
    {
      updateMany: {
        filter: { edad: { $lt: 22 } },
        update: { $set: { categoria: "junior" } },
      },
    },
    {
      updateMany: {
        filter: { edad: { $gte: 22 } },
        update: { $set: { categoria: "senior" } },
      },
    },
  ],
  { ordered: false }
);
```
